@model QuizApp.Models.Quiz
@{
    ViewData["Title"] = Model.Title;
    var minutes = (int)ViewBag.Minutes;
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="mb-0">@Model.Title</h1>
    <div class="d-flex gap-2 align-items-center">
        <span class="badge bg-dark badge-lg">Elapsed: <span id="stopwatch">00:00</span></span>
        <span class="badge bg-primary badge-lg">Time left: <span id="timer">@minutes:00</span></span>
    </div>
</div>

<!-- Форма за резултата -->
<form asp-action="Result" method="post" class="fade-in-up">
    @Html.AntiForgeryToken()
    <input type="hidden" name="quizId" value="@Model.Id" />

    @for (int i = 0; i < Model.Questions.Count; i++)
    {
        var q = Model.Questions[i];
        <div class="mb-4 p-3 border rounded bg-white">
            <div class="d-flex justify-content-between align-items-center mb-1">
                <h5 class="mb-0 text-secondary">Question @(i + 1) of @Model.Questions.Count</h5>
                <span class="text-muted small">@q.Id</span>
            </div>
            <p class="fw-semibold fs-5 mb-2">@q.Text</p>

            @for (int j = 0; j < q.Options.Count; j++)
            {
                <label class="form-check option-line fs-6">
                    <input class="form-check-input me-2" type="radio" name="answers[@i]" value="@j" />
                    <span class="form-check-label">
                        <strong>@("ABCD"[j]).</strong> @q.Options[j]
                    </span>
                </label>
            }
        </div>
    }

    <button type="submit" class="btn btn-success btn-lg">
        Submit
    </button>
</form>

<!-- Отделна форма за Retake (вън от горната!) -->
<form asp-action="Retake" method="post" class="mt-3">
    @Html.AntiForgeryToken()
    <input type="hidden" name="quizId" value="@Model.Id" />
    <button type="submit" class="btn btn-outline-secondary btn-lg">
        Retake Quiz
    </button>
</form>

@section Scripts {
    <script>
        window.startCountdown && window.startCountdown(@minutes);
        window.startStopwatch && window.startStopwatch();
    </script>
}
